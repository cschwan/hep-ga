#include <tuple>

#include <hep/product.hpp>

#include <boost/test/unit_test.hpp>

// multi vector with metric (1,3) and general grade list
template <std::size_t L>
using mv4 = hep::multi_vector<float, 1, 3, L>;

BOOST_AUTO_TEST_CASE(geometric_product)
{
	auto lhs = std::make_tuple(
		mv4< 1>{ 2.0f },
		mv4< 2>{ 5.0f, 7.0f, 11.0f, 13.0f },
		mv4< 4>{ 31.0f, 37.0f, 41.0f, 43.0f,
		         47.0f, 53.0f },
		mv4< 8>{ 83.0f, 89.0f, 97.0f, 101.0f },
		mv4<16>{ 127.0f },
		mv4<21>{ 137.0f, 139.0f, 149.0f, 151.0f,
		         157.0f, 163.0f, 167.0f, 173.0f },
		mv4<31>{ 227.0f, 229.0f, 233.0f, 241.0f,
		         269.0f, 239.0f, 251.0f, 257.0f,
		         271.0f, 277.0f, 283.0f, 263.0f,
		         281.0f, 293.0f, 307.0f, 311.0f }
	);

	auto rhs = std::make_tuple(
		mv4< 1>{ 3.0f },
		mv4< 2>{ 17.0f, 19.0f, 23.0f, 29.0f },
		mv4< 4>{ 59.0f, 61.0f, 67.0f, 71.0f,
		         73.0f, 79.0f },
		mv4< 8>{ 103.0f, 107.0f, 109.0f, 113.0f },
		mv4<16>{ 131.0f },
		mv4<21>{ 179.0f, 181.0f, 191.0f, 193.0f,
		         197.0f, 199.0f, 211.0f, 223.0f },
		mv4<31>{ 313.0f, 317.0f, 331.0f, 347.0f,
		         367.0f, 337.0f, 349.0f, 353.0f,
		         373.0f, 379.0f, 389.0f, 359.0f,
		         383.0f, 397.0f, 401.0f, 409.0f }
	);

	mv4<1> mv00 = std::get<0>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv00[0], 6.0f);

	mv4<2> mv01 = std::get<0>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv01[0], 34.0f);
	BOOST_CHECK_EQUAL(mv01[1], 38.0f);
	BOOST_CHECK_EQUAL(mv01[2], 46.0f);
	BOOST_CHECK_EQUAL(mv01[3], 58.0f);

	mv4<4> mv02 = std::get<0>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv02[0], 118.0f);
	BOOST_CHECK_EQUAL(mv02[1], 122.0f);
	BOOST_CHECK_EQUAL(mv02[2], 134.0f);
	BOOST_CHECK_EQUAL(mv02[3], 142.0f);
	BOOST_CHECK_EQUAL(mv02[4], 146.0f);
	BOOST_CHECK_EQUAL(mv02[5], 158.0f);

	mv4<8> mv03 = std::get<0>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv03[0], 206.0f);
	BOOST_CHECK_EQUAL(mv03[1], 214.0f);
	BOOST_CHECK_EQUAL(mv03[2], 218.0f);
	BOOST_CHECK_EQUAL(mv03[3], 226.0f);

	mv4<16> mv04 = std::get<0>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv04[0], 262.0f);

	mv4<21> mv05 = std::get<0>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv05[0], 358.0f);
	BOOST_CHECK_EQUAL(mv05[1], 362.0f);
	BOOST_CHECK_EQUAL(mv05[2], 382.0f);
	BOOST_CHECK_EQUAL(mv05[3], 386.0f);
	BOOST_CHECK_EQUAL(mv05[4], 394.0f);
	BOOST_CHECK_EQUAL(mv05[5], 398.0f);
	BOOST_CHECK_EQUAL(mv05[6], 422.0f);
	BOOST_CHECK_EQUAL(mv05[7], 446.0f);

	mv4<31> mv06 = std::get<0>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv06[0], 626.0f);
	BOOST_CHECK_EQUAL(mv06[1], 634.0f);
	BOOST_CHECK_EQUAL(mv06[2], 662.0f);
	BOOST_CHECK_EQUAL(mv06[3], 694.0f);
	BOOST_CHECK_EQUAL(mv06[4], 734.0f);
	BOOST_CHECK_EQUAL(mv06[5], 674.0f);
	BOOST_CHECK_EQUAL(mv06[6], 698.0f);
	BOOST_CHECK_EQUAL(mv06[7], 706.0f);
	BOOST_CHECK_EQUAL(mv06[8], 746.0f);
	BOOST_CHECK_EQUAL(mv06[9], 758.0f);
	BOOST_CHECK_EQUAL(mv06[10], 778.0f);
	BOOST_CHECK_EQUAL(mv06[11], 718.0f);
	BOOST_CHECK_EQUAL(mv06[12], 766.0f);
	BOOST_CHECK_EQUAL(mv06[13], 794.0f);
	BOOST_CHECK_EQUAL(mv06[14], 802.0f);
	BOOST_CHECK_EQUAL(mv06[15], 818.0f);

	mv4<2> mv10 = std::get<1>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv10[0], 15.0f);
	BOOST_CHECK_EQUAL(mv10[1], 21.0f);
	BOOST_CHECK_EQUAL(mv10[2], 33.0f);
	BOOST_CHECK_EQUAL(mv10[3], 39.0f);

	mv4<5> mv11 = std::get<1>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv11[0], -678.0f);
	BOOST_CHECK_EQUAL(mv11[1], -24.0f);
	BOOST_CHECK_EQUAL(mv11[2], -72.0f);
	BOOST_CHECK_EQUAL(mv11[3], -48.0f);
	BOOST_CHECK_EQUAL(mv11[4], -76.0f);
	BOOST_CHECK_EQUAL(mv11[5], -44.0f);
	BOOST_CHECK_EQUAL(mv11[6], 20.0f);

	mv4<10> mv12 = std::get<1>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv12[0], 2007.0f);
	BOOST_CHECK_EQUAL(mv12[1], 1981.0f);
	BOOST_CHECK_EQUAL(mv12[2], 863.0f);
	BOOST_CHECK_EQUAL(mv12[3], -1025.0f);
	BOOST_CHECK_EQUAL(mv12[4], 557.0f);
	BOOST_CHECK_EQUAL(mv12[5], 635.0f);
	BOOST_CHECK_EQUAL(mv12[6], 407.0f);
	BOOST_CHECK_EQUAL(mv12[7], 621.0f);

	mv4<20> mv13 = std::get<1>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv13[0], -2524.0f);
	BOOST_CHECK_EQUAL(mv13[1], -696.0f);
	BOOST_CHECK_EQUAL(mv13[2], -954.0f);
	BOOST_CHECK_EQUAL(mv13[3], 1948.0f);
	BOOST_CHECK_EQUAL(mv13[4], 1778.0f);
	BOOST_CHECK_EQUAL(mv13[5], -246.0f);
	BOOST_CHECK_EQUAL(mv13[6], -360.0f);

	mv4<8> mv14 = std::get<1>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv14[0], 1703.0f);
	BOOST_CHECK_EQUAL(mv14[1], -1441.0f);
	BOOST_CHECK_EQUAL(mv14[2], 917.0f);
	BOOST_CHECK_EQUAL(mv14[3], 655.0f);

	mv4<10> mv15 = std::get<1>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv15[0], 6824.0f);
	BOOST_CHECK_EQUAL(mv15[1], 6868.0f);
	BOOST_CHECK_EQUAL(mv15[2], 4316.0f);
	BOOST_CHECK_EQUAL(mv15[3], -402.0f);
	BOOST_CHECK_EQUAL(mv15[4], 4518.0f);
	BOOST_CHECK_EQUAL(mv15[5], -484.0f);
	BOOST_CHECK_EQUAL(mv15[6], 2932.0f);
	BOOST_CHECK_EQUAL(mv15[7], 2912.0f);

	mv4<31> mv16 = std::get<1>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv16[0], -9320.0f);
	BOOST_CHECK_EQUAL(mv16[1], 12612.0f);
	BOOST_CHECK_EQUAL(mv16[2], 12686.0f);
	BOOST_CHECK_EQUAL(mv16[3], 7774.0f);
	BOOST_CHECK_EQUAL(mv16[4], -998.0f);
	BOOST_CHECK_EQUAL(mv16[5], -9492.0f);
	BOOST_CHECK_EQUAL(mv16[6], -4400.0f);
	BOOST_CHECK_EQUAL(mv16[7], -4630.0f);
	BOOST_CHECK_EQUAL(mv16[8], 4762.0f);
	BOOST_CHECK_EQUAL(mv16[9], 4592.0f);
	BOOST_CHECK_EQUAL(mv16[10], -1296.0f);
	BOOST_CHECK_EQUAL(mv16[11], 8346.0f);
	BOOST_CHECK_EQUAL(mv16[12], -834.0f);
	BOOST_CHECK_EQUAL(mv16[13], 5242.0f);
	BOOST_CHECK_EQUAL(mv16[14], 5188.0f);
	BOOST_CHECK_EQUAL(mv16[15], -1228.0f);

	mv4<4> mv20 = std::get<2>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv20[0], 93.0f);
	BOOST_CHECK_EQUAL(mv20[1], 111.0f);
	BOOST_CHECK_EQUAL(mv20[2], 123.0f);
	BOOST_CHECK_EQUAL(mv20[3], 129.0f);
	BOOST_CHECK_EQUAL(mv20[4], 141.0f);
	BOOST_CHECK_EQUAL(mv20[5], 159.0f);

	mv4<10> mv21 = std::get<2>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv21[0], -2687.0f);
	BOOST_CHECK_EQUAL(mv21[1], -2833.0f);
	BOOST_CHECK_EQUAL(mv21[2], -1387.0f);
	BOOST_CHECK_EQUAL(mv21[3], 1381.0f);
	BOOST_CHECK_EQUAL(mv21[4], 707.0f);
	BOOST_CHECK_EQUAL(mv21[5], 881.0f);
	BOOST_CHECK_EQUAL(mv21[6], 985.0f);
	BOOST_CHECK_EQUAL(mv21[7], 1115.0f);

	mv4<21> mv22 = std::get<2>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv22[0], -3226.0f);
	BOOST_CHECK_EQUAL(mv22[1], -220.0f);
	BOOST_CHECK_EQUAL(mv22[2], -24.0f);
	BOOST_CHECK_EQUAL(mv22[3], 136.0f);
	BOOST_CHECK_EQUAL(mv22[4], 820.0f);
	BOOST_CHECK_EQUAL(mv22[5], 648.0f);
	BOOST_CHECK_EQUAL(mv22[6], -160.0f);
	BOOST_CHECK_EQUAL(mv22[7], 5800.0f);

	mv4<10> mv23 = std::get<2>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv23[0], -15029.0f);
	BOOST_CHECK_EQUAL(mv23[1], -14401.0f);
	BOOST_CHECK_EQUAL(mv23[2], 3817.0f);
	BOOST_CHECK_EQUAL(mv23[3], 2717.0f);
	BOOST_CHECK_EQUAL(mv23[4], -5407.0f);
	BOOST_CHECK_EQUAL(mv23[5], 5171.0f);
	BOOST_CHECK_EQUAL(mv23[6], -3957.0f);
	BOOST_CHECK_EQUAL(mv23[7], -3849.0f);

	mv4<4> mv24 = std::get<2>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv24[0], -6943.0f);
	BOOST_CHECK_EQUAL(mv24[1], 6157.0f);
	BOOST_CHECK_EQUAL(mv24[2], 5633.0f);
	BOOST_CHECK_EQUAL(mv24[3], -5371.0f);
	BOOST_CHECK_EQUAL(mv24[4], -4847.0f);
	BOOST_CHECK_EQUAL(mv24[5], 4061.0f);

	mv4<21> mv25 = std::get<2>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv25[0], -7300.0f);
	BOOST_CHECK_EQUAL(mv25[1], -7662.0f);
	BOOST_CHECK_EQUAL(mv25[2], 17174.0f);
	BOOST_CHECK_EQUAL(mv25[3], 17074.0f);
	BOOST_CHECK_EQUAL(mv25[4], 3208.0f);
	BOOST_CHECK_EQUAL(mv25[5], 3416.0f);
	BOOST_CHECK_EQUAL(mv25[6], 16412.0f);
	BOOST_CHECK_EQUAL(mv25[7], 16170.0f);

	mv4<31> mv26 = std::get<2>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv26[0], -13504.0f);
	BOOST_CHECK_EQUAL(mv26[1], -92642.0f);
	BOOST_CHECK_EQUAL(mv26[2], -92308.0f);
	BOOST_CHECK_EQUAL(mv26[3], -4704.0f);
	BOOST_CHECK_EQUAL(mv26[4], 30438.0f);
	BOOST_CHECK_EQUAL(mv26[5], -14456.0f);
	BOOST_CHECK_EQUAL(mv26[6], 30636.0f);
	BOOST_CHECK_EQUAL(mv26[7], 30266.0f);
	BOOST_CHECK_EQUAL(mv26[8], 4884.0f);
	BOOST_CHECK_EQUAL(mv26[9], 5266.0f);
	BOOST_CHECK_EQUAL(mv26[10], 29422.0f);
	BOOST_CHECK_EQUAL(mv26[11], -7376.0f);
	BOOST_CHECK_EQUAL(mv26[12], 29630.0f);
	BOOST_CHECK_EQUAL(mv26[13], 1858.0f);
	BOOST_CHECK_EQUAL(mv26[14], 2708.0f);
	BOOST_CHECK_EQUAL(mv26[15], 29966.0f);

	mv4<8> mv30 = std::get<3>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv30[0], 249.0f);
	BOOST_CHECK_EQUAL(mv30[1], 267.0f);
	BOOST_CHECK_EQUAL(mv30[2], 291.0f);
	BOOST_CHECK_EQUAL(mv30[3], 303.0f);

	mv4<20> mv31 = std::get<3>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv31[0], -4490.0f);
	BOOST_CHECK_EQUAL(mv31[1], -1236.0f);
	BOOST_CHECK_EQUAL(mv31[2], -1518.0f);
	BOOST_CHECK_EQUAL(mv31[3], 3922.0f);
	BOOST_CHECK_EQUAL(mv31[4], 3836.0f);
	BOOST_CHECK_EQUAL(mv31[5], -270.0f);
	BOOST_CHECK_EQUAL(mv31[6], 486.0f);

	mv4<10> mv32 = std::get<3>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv32[0], -19721.0f);
	BOOST_CHECK_EQUAL(mv32[1], -19361.0f);
	BOOST_CHECK_EQUAL(mv32[2], 5383.0f);
	BOOST_CHECK_EQUAL(mv32[3], 4401.0f);
	BOOST_CHECK_EQUAL(mv32[4], 7121.0f);
	BOOST_CHECK_EQUAL(mv32[5], -6219.0f);
	BOOST_CHECK_EQUAL(mv32[6], 6055.0f);
	BOOST_CHECK_EQUAL(mv32[7], 6187.0f);

	mv4<5> mv33 = std::get<3>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv33[0], -17232.0f);
	BOOST_CHECK_EQUAL(mv33[1], 48.0f);
	BOOST_CHECK_EQUAL(mv33[2], -750.0f);
	BOOST_CHECK_EQUAL(mv33[3], -678.0f);
	BOOST_CHECK_EQUAL(mv33[4], 1024.0f);
	BOOST_CHECK_EQUAL(mv33[5], 944.0f);
	BOOST_CHECK_EQUAL(mv33[6], -286.0f);

	mv4<2> mv34 = std::get<3>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv34[0], -13231.0f);
	BOOST_CHECK_EQUAL(mv34[1], -12707.0f);
	BOOST_CHECK_EQUAL(mv34[2], 11659.0f);
	BOOST_CHECK_EQUAL(mv34[3], -10873.0f);

	mv4<10> mv35 = std::get<3>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv35[0], -76720.0f);
	BOOST_CHECK_EQUAL(mv35[1], -76328.0f);
	BOOST_CHECK_EQUAL(mv35[2], 35860.0f);
	BOOST_CHECK_EQUAL(mv35[3], -3366.0f);
	BOOST_CHECK_EQUAL(mv35[4], 34230.0f);
	BOOST_CHECK_EQUAL(mv35[5], -2152.0f);
	BOOST_CHECK_EQUAL(mv35[6], 34984.0f);
	BOOST_CHECK_EQUAL(mv35[7], 34988.0f);

	mv4<31> mv36 = std::get<3>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv36[0], -61892.0f);
	BOOST_CHECK_EQUAL(mv36[1], -142072.0f);
	BOOST_CHECK_EQUAL(mv36[2], -141126.0f);
	BOOST_CHECK_EQUAL(mv36[3], 66470.0f);
	BOOST_CHECK_EQUAL(mv36[4], -5754.0f);
	BOOST_CHECK_EQUAL(mv36[5], -60264.0f);
	BOOST_CHECK_EQUAL(mv36[6], -11120.0f);
	BOOST_CHECK_EQUAL(mv36[7], -12574.0f);
	BOOST_CHECK_EQUAL(mv36[8], 66094.0f);
	BOOST_CHECK_EQUAL(mv36[9], 65132.0f);
	BOOST_CHECK_EQUAL(mv36[10], -2844.0f);
	BOOST_CHECK_EQUAL(mv36[11], 61510.0f);
	BOOST_CHECK_EQUAL(mv36[12], -5438.0f);
	BOOST_CHECK_EQUAL(mv36[13], 64438.0f);
	BOOST_CHECK_EQUAL(mv36[14], 64200.0f);
	BOOST_CHECK_EQUAL(mv36[15], -332.0f);

	mv4<16> mv40 = std::get<4>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv40[0], 381.0f);

	mv4<8> mv41 = std::get<4>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv41[0], -3683.0f);
	BOOST_CHECK_EQUAL(mv41[1], 2921.0f);
	BOOST_CHECK_EQUAL(mv41[2], -2413.0f);
	BOOST_CHECK_EQUAL(mv41[3], -2159.0f);

	mv4<4> mv42 = std::get<4>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv42[0], -10033.0f);
	BOOST_CHECK_EQUAL(mv42[1], 9271.0f);
	BOOST_CHECK_EQUAL(mv42[2], 9017.0f);
	BOOST_CHECK_EQUAL(mv42[3], -8509.0f);
	BOOST_CHECK_EQUAL(mv42[4], -7747.0f);
	BOOST_CHECK_EQUAL(mv42[5], 7493.0f);

	mv4<2> mv43 = std::get<4>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv43[0], 14351.0f);
	BOOST_CHECK_EQUAL(mv43[1], 13843.0f);
	BOOST_CHECK_EQUAL(mv43[2], -13589.0f);
	BOOST_CHECK_EQUAL(mv43[3], 13081.0f);

	mv4<1> mv44 = std::get<4>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv44[0], -16637.0f);

	mv4<21> mv45 = std::get<4>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv45[0], -28321.0f);
	BOOST_CHECK_EQUAL(mv45[1], -26797.0f);
	BOOST_CHECK_EQUAL(mv45[2], 25273.0f);
	BOOST_CHECK_EQUAL(mv45[3], 25019.0f);
	BOOST_CHECK_EQUAL(mv45[4], -24511.0f);
	BOOST_CHECK_EQUAL(mv45[5], -24257.0f);
	BOOST_CHECK_EQUAL(mv45[6], 22987.0f);
	BOOST_CHECK_EQUAL(mv45[7], 22733.0f);

	mv4<31> mv46 = std::get<4>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv46[0], -51943.0f);
	BOOST_CHECK_EQUAL(mv46[1], 50927.0f);
	BOOST_CHECK_EQUAL(mv46[2], 50419.0f);
	BOOST_CHECK_EQUAL(mv46[3], -48641.0f);
	BOOST_CHECK_EQUAL(mv46[4], 45593.0f);
	BOOST_CHECK_EQUAL(mv46[5], -49403.0f);
	BOOST_CHECK_EQUAL(mv46[6], 48133.0f);
	BOOST_CHECK_EQUAL(mv46[7], 47371.0f);
	BOOST_CHECK_EQUAL(mv46[8], -44831.0f);
	BOOST_CHECK_EQUAL(mv46[9], -44323.0f);
	BOOST_CHECK_EQUAL(mv46[10], 42799.0f);
	BOOST_CHECK_EQUAL(mv46[11], -46609.0f);
	BOOST_CHECK_EQUAL(mv46[12], 44069.0f);
	BOOST_CHECK_EQUAL(mv46[13], -42037.0f);
	BOOST_CHECK_EQUAL(mv46[14], -40259.0f);
	BOOST_CHECK_EQUAL(mv46[15], 39751.0f);

	mv4<21> mv50 = std::get<5>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv50[0], 411.0f);
	BOOST_CHECK_EQUAL(mv50[1], 417.0f);
	BOOST_CHECK_EQUAL(mv50[2], 447.0f);
	BOOST_CHECK_EQUAL(mv50[3], 453.0f);
	BOOST_CHECK_EQUAL(mv50[4], 471.0f);
	BOOST_CHECK_EQUAL(mv50[5], 489.0f);
	BOOST_CHECK_EQUAL(mv50[6], 501.0f);
	BOOST_CHECK_EQUAL(mv50[7], 519.0f);

	mv4<10> mv51 = std::get<5>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv51[0], -8292.0f);
	BOOST_CHECK_EQUAL(mv51[1], -7960.0f);
	BOOST_CHECK_EQUAL(mv51[2], -1356.0f);
	BOOST_CHECK_EQUAL(mv51[3], 8242.0f);
	BOOST_CHECK_EQUAL(mv51[4], -2084.0f);
	BOOST_CHECK_EQUAL(mv51[5], 7798.0f);
	BOOST_CHECK_EQUAL(mv51[6], 262.0f);
	BOOST_CHECK_EQUAL(mv51[7], 862.0f);

	mv4<21> mv52 = std::get<5>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv52[0], -6772.0f);
	BOOST_CHECK_EQUAL(mv52[1], -4924.0f);
	BOOST_CHECK_EQUAL(mv52[2], 21128.0f);
	BOOST_CHECK_EQUAL(mv52[3], 22460.0f);
	BOOST_CHECK_EQUAL(mv52[4], -3978.0f);
	BOOST_CHECK_EQUAL(mv52[5], -1898.0f);
	BOOST_CHECK_EQUAL(mv52[6], 20130.0f);
	BOOST_CHECK_EQUAL(mv52[7], 21254.0f);

	mv4<10> mv53 = std::get<5>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv53[0], -31648.0f);
	BOOST_CHECK_EQUAL(mv53[1], -32160.0f);
	BOOST_CHECK_EQUAL(mv53[2], -2888.0f);
	BOOST_CHECK_EQUAL(mv53[3], 31870.0f);
	BOOST_CHECK_EQUAL(mv53[4], -3732.0f);
	BOOST_CHECK_EQUAL(mv53[5], 32238.0f);
	BOOST_CHECK_EQUAL(mv53[6], -1406.0f);
	BOOST_CHECK_EQUAL(mv53[7], 102.0f);

	mv4<21> mv54 = std::get<5>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv54[0], -22663.0f);
	BOOST_CHECK_EQUAL(mv54[1], -21877.0f);
	BOOST_CHECK_EQUAL(mv54[2], 21353.0f);
	BOOST_CHECK_EQUAL(mv54[3], 20567.0f);
	BOOST_CHECK_EQUAL(mv54[4], -19781.0f);
	BOOST_CHECK_EQUAL(mv54[5], -19519.0f);
	BOOST_CHECK_EQUAL(mv54[6], 18209.0f);
	BOOST_CHECK_EQUAL(mv54[7], 17947.0f);

	mv4<21> mv55 = std::get<5>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv55[0], -26326.0f);
	BOOST_CHECK_EQUAL(mv55[1], -25018.0f);
	BOOST_CHECK_EQUAL(mv55[2], 124346.0f);
	BOOST_CHECK_EQUAL(mv55[3], 124142.0f);
	BOOST_CHECK_EQUAL(mv55[4], -9670.0f);
	BOOST_CHECK_EQUAL(mv55[5], -8426.0f);
	BOOST_CHECK_EQUAL(mv55[6], 120334.0f);
	BOOST_CHECK_EQUAL(mv55[7], 120338.0f);

	mv4<31> mv56 = std::get<5>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv56[0], -50514.0f);
	BOOST_CHECK_EQUAL(mv56[1], -225466.0f);
	BOOST_CHECK_EQUAL(mv56[2], -222842.0f);
	BOOST_CHECK_EQUAL(mv56[3], -24326.0f);
	BOOST_CHECK_EQUAL(mv56[4], 226358.0f);
	BOOST_CHECK_EQUAL(mv56[5], -47322.0f);
	BOOST_CHECK_EQUAL(mv56[6], 227286.0f);
	BOOST_CHECK_EQUAL(mv56[7], 226182.0f);
	BOOST_CHECK_EQUAL(mv56[8], -20014.0f);
	BOOST_CHECK_EQUAL(mv56[9], -17102.0f);
	BOOST_CHECK_EQUAL(mv56[10], 219622.0f);
	BOOST_CHECK_EQUAL(mv56[11], -29734.0f);
	BOOST_CHECK_EQUAL(mv56[12], 222974.0f);
	BOOST_CHECK_EQUAL(mv56[13], -6154.0f);
	BOOST_CHECK_EQUAL(mv56[14], -250.0f);
	BOOST_CHECK_EQUAL(mv56[15], 218918.0f);

	mv4<31> mv60 = std::get<6>(lhs) * std::get<0>(rhs);

	BOOST_CHECK_EQUAL(mv60[0], 681.0f);
	BOOST_CHECK_EQUAL(mv60[1], 687.0f);
	BOOST_CHECK_EQUAL(mv60[2], 699.0f);
	BOOST_CHECK_EQUAL(mv60[3], 723.0f);
	BOOST_CHECK_EQUAL(mv60[4], 807.0f);
	BOOST_CHECK_EQUAL(mv60[5], 717.0f);
	BOOST_CHECK_EQUAL(mv60[6], 753.0f);
	BOOST_CHECK_EQUAL(mv60[7], 771.0f);
	BOOST_CHECK_EQUAL(mv60[8], 813.0f);
	BOOST_CHECK_EQUAL(mv60[9], 831.0f);
	BOOST_CHECK_EQUAL(mv60[10], 849.0f);
	BOOST_CHECK_EQUAL(mv60[11], 789.0f);
	BOOST_CHECK_EQUAL(mv60[12], 843.0f);
	BOOST_CHECK_EQUAL(mv60[13], 879.0f);
	BOOST_CHECK_EQUAL(mv60[14], 921.0f);
	BOOST_CHECK_EQUAL(mv60[15], 933.0f);

	mv4<31> mv61 = std::get<6>(lhs) * std::get<1>(rhs);

	BOOST_CHECK_EQUAL(mv61[0], -13878.0f);
	BOOST_CHECK_EQUAL(mv61[1], -14314.0f);
	BOOST_CHECK_EQUAL(mv61[2], -13694.0f);
	BOOST_CHECK_EQUAL(mv61[3], -2370.0f);
	BOOST_CHECK_EQUAL(mv61[4], 13748.0f);
	BOOST_CHECK_EQUAL(mv61[5], -13808.0f);
	BOOST_CHECK_EQUAL(mv61[6], -2330.0f);
	BOOST_CHECK_EQUAL(mv61[7], -3652.0f);
	BOOST_CHECK_EQUAL(mv61[8], 14146.0f);
	BOOST_CHECK_EQUAL(mv61[9], 13484.0f);
	BOOST_CHECK_EQUAL(mv61[10], -50.0f);
	BOOST_CHECK_EQUAL(mv61[11], -3922.0f);
	BOOST_CHECK_EQUAL(mv61[12], 13644.0f);
	BOOST_CHECK_EQUAL(mv61[13], -52.0f);
	BOOST_CHECK_EQUAL(mv61[14], 1172.0f);
	BOOST_CHECK_EQUAL(mv61[15], 1512.0f);

	mv4<31> mv62 = std::get<6>(lhs) * std::get<2>(rhs);

	BOOST_CHECK_EQUAL(mv62[0], -11144.0f);
	BOOST_CHECK_EQUAL(mv62[1], -13734.0f);
	BOOST_CHECK_EQUAL(mv62[2], -10952.0f);
	BOOST_CHECK_EQUAL(mv62[3], 36734.0f);
	BOOST_CHECK_EQUAL(mv62[4], -5906.0f);
	BOOST_CHECK_EQUAL(mv62[5], -9920.0f);
	BOOST_CHECK_EQUAL(mv62[6], 37016.0f);
	BOOST_CHECK_EQUAL(mv62[7], 38744.0f);
	BOOST_CHECK_EQUAL(mv62[8], -8390.0f);
	BOOST_CHECK_EQUAL(mv62[9],  -4722.0f);
	BOOST_CHECK_EQUAL(mv62[10], 35194.0f);
	BOOST_CHECK_EQUAL(mv62[11],37956.0f);
	BOOST_CHECK_EQUAL(mv62[12], -3828.0f);
	BOOST_CHECK_EQUAL(mv62[13], 35874.0f);
	BOOST_CHECK_EQUAL(mv62[14], 37656.0f);
	BOOST_CHECK_EQUAL(mv62[15], 36762.0f);

	mv4<31> mv63 = std::get<6>(lhs) * std::get<3>(rhs);

	BOOST_CHECK_EQUAL(mv63[0], -54402.0f);
	BOOST_CHECK_EQUAL(mv63[1], -51814.0f);
	BOOST_CHECK_EQUAL(mv63[2], -52930.0f);
	BOOST_CHECK_EQUAL(mv63[3], -6898.0f);
	BOOST_CHECK_EQUAL(mv63[4], 55924.0f);
	BOOST_CHECK_EQUAL(mv63[5], -53252.0f);
	BOOST_CHECK_EQUAL(mv63[6], -6418.0f);
	BOOST_CHECK_EQUAL(mv63[7], -7532.0f);
	BOOST_CHECK_EQUAL(mv63[8], 53102.0f);
	BOOST_CHECK_EQUAL(mv63[9], 53248.0f);
	BOOST_CHECK_EQUAL(mv63[10], -2170.0f);
	BOOST_CHECK_EQUAL(mv63[11], -7330.0f);
	BOOST_CHECK_EQUAL(mv63[12], 53788.0f);
	BOOST_CHECK_EQUAL(mv63[13], -3296.0f);
	BOOST_CHECK_EQUAL(mv63[14], -1456.0f);
	BOOST_CHECK_EQUAL(mv63[15], -1440.0f);

	mv4<31> mv64 = std::get<6>(lhs) * std::get<4>(rhs);

	BOOST_CHECK_EQUAL(mv64[0], -40741.0f);
	BOOST_CHECK_EQUAL(mv64[1], -40217.0f);
	BOOST_CHECK_EQUAL(mv64[2], -38383.0f);
	BOOST_CHECK_EQUAL(mv64[3], 36811.0f);
	BOOST_CHECK_EQUAL(mv64[4], -34453.0f);
	BOOST_CHECK_EQUAL(mv64[5], -37073.0f);
	BOOST_CHECK_EQUAL(mv64[6], 36287.0f);
	BOOST_CHECK_EQUAL(mv64[7], 35501.0f);
	BOOST_CHECK_EQUAL(mv64[8], -33667.0f);
	BOOST_CHECK_EQUAL(mv64[9],  -32881.0f);
	BOOST_CHECK_EQUAL(mv64[10], 31309.0f);
	BOOST_CHECK_EQUAL(mv64[11],35239.0f);
	BOOST_CHECK_EQUAL(mv64[12], -31571.0f);
	BOOST_CHECK_EQUAL(mv64[13], 30523.0f);
	BOOST_CHECK_EQUAL(mv64[14], 29999.0f);
	BOOST_CHECK_EQUAL(mv64[15], 29737.0f);

	mv4<31> mv65 = std::get<6>(lhs) * std::get<5>(rhs);

	BOOST_CHECK_EQUAL(mv65[0], -48570.0f);
	BOOST_CHECK_EQUAL(mv65[1], -54774.0f);
	BOOST_CHECK_EQUAL(mv65[2], -52506.0f);
	BOOST_CHECK_EQUAL(mv65[3], 212306.0f);
	BOOST_CHECK_EQUAL(mv65[4], -15030.0f);
	BOOST_CHECK_EQUAL(mv65[5], -46146.0f);
	BOOST_CHECK_EQUAL(mv65[6], 213766.0f);
	BOOST_CHECK_EQUAL(mv65[7], 213426.0f);
	BOOST_CHECK_EQUAL(mv65[8], -20438.0f);
	BOOST_CHECK_EQUAL(mv65[9],  -18258.0f);
	BOOST_CHECK_EQUAL(mv65[10], 208138.0f);
	BOOST_CHECK_EQUAL(mv65[11], 211842.0f);
	BOOST_CHECK_EQUAL(mv65[12], -12666.0f);
	BOOST_CHECK_EQUAL(mv65[13], 210298.0f);
	BOOST_CHECK_EQUAL(mv65[14], 210314.0f);
	BOOST_CHECK_EQUAL(mv65[15], 208018.0f);

	mv4<31> mv66 = std::get<6>(lhs) * std::get<6>(rhs);

	BOOST_CHECK_EQUAL(mv66[0], -474848.0f);
	BOOST_CHECK_EQUAL(mv66[1], -483932.0f);
	BOOST_CHECK_EQUAL(mv66[2], -474116.0f);
	BOOST_CHECK_EQUAL(mv66[3], 338956.0f);
	BOOST_CHECK_EQUAL(mv66[4], 355640.0f);
	BOOST_CHECK_EQUAL(mv66[5], -464732.0f);
	BOOST_CHECK_EQUAL(mv66[6], 345592.0f);
	BOOST_CHECK_EQUAL(mv66[7], 334548.0f);
	BOOST_CHECK_EQUAL(mv66[8], 341612.0f);
	BOOST_CHECK_EQUAL(mv66[9], 340844.0f);
	BOOST_CHECK_EQUAL(mv66[10], 363716.0f);
	BOOST_CHECK_EQUAL(mv66[11], 327436.0f);
	BOOST_CHECK_EQUAL(mv66[12], 354796.0f);
	BOOST_CHECK_EQUAL(mv66[13], 362136.0f);
	BOOST_CHECK_EQUAL(mv66[14], 371052.0f);
	BOOST_CHECK_EQUAL(mv66[15], 371988.0f);
}
